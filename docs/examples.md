# Examples

## Create Your First Lightflus Application

Letâ€™s start to create your first Lightflus Application

- Generate Lightflus app file by CLI

```bash
lightflus create-task wordCount
```

You will find a Typescript file generated:

```typescript
// wordCount.ts
// generated by tableflow cli
// Tableflow will only execute the function with the same name of task file

function wordCount(ctx: ExecutionContext) {
    // TODO the logic code
}
```

- Write The logic code

```typescript
// wordCount.ts
// generated by tableflow cli
// Tableflow will only execute the function with the same name of task task

function wordCount(ctx: ExecutionContext) {
    let source = Kafka.builder()
        .brokers(["xxxx:9092"])
        .topic("topic")
        .build<string>();
    let sink = Elastic.builder()
        .host("xxx")
        .index("wordCount")
        .sinkMode(SinkMode.APPEND)
        .build<Tuple2<string, number>>();

    let stream = ctx.fromSource(source);
    stream.flatMap(value => value.map(v => new Tuple2(v, 1)))
        .keyBy(v => v.t0)
        .window(FixedWindow.size(Time.seconds(5)))
        .reduce((agg, current) => {
            agg.t1 = agg.t1 + current.t1;
            return agg;
        })
        .sink(sink);
}
```

- And then you can deploy your application on remote cluster by one cmd

```bash
lightflus apply -f wordCount.ts
```